{"ast":null,"code":"import _regeneratorRuntime from \"/Users/justinsasek/Code/TPEO/full-stack-learning-repo-2022/Week_9/homework frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _asyncToGenerator from \"/Users/justinsasek/Code/TPEO/full-stack-learning-repo-2022/Week_9/homework frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport _slicedToArray from \"/Users/justinsasek/Code/TPEO/full-stack-learning-repo-2022/Week_9/homework frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";\nvar _s = $RefreshSig$();\n// based on the tutorial from https://usehooks.com/useAuth/\n\nimport { createContext, useState } from \"react\";\n// a bug with this hook prevented me from using it ðŸ˜¢\n// import { useLocalStorage } from \"@mantine/hooks\";\nimport { useNavigate } from \"react-router-dom\";\nvar AuthContext = /*#__PURE__*/createContext();\n\n// This is what we export from this file\nexport default AuthContext;\n\n// Provider hook that creates auth object and handles state\nexport function useProvideAuth() {\n  _s();\n  var navigate = useNavigate();\n  var _useState = useState(window.localStorage.getItem(\"loggedIn\")),\n    _useState2 = _slicedToArray(_useState, 2),\n    loggedIn = _useState2[0],\n    setLoggedIn = _useState2[1];\n  function login(_x, _x2) {\n    return _login.apply(this, arguments);\n  }\n  function _login() {\n    _login = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee(values, form) {\n      var myHeaders, raw, requestOptions;\n      return _regeneratorRuntime().wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              myHeaders = new Headers();\n              myHeaders.append(\"Content-Type\", \"application/json\");\n              raw = JSON.stringify({\n                email: values.email,\n                password: values.password\n              });\n              requestOptions = {\n                method: 'POST',\n                headers: myHeaders,\n                body: raw,\n                redirect: 'follow'\n              };\n              fetch(\"http://localhost:5001/auth/login/\", requestOptions).then(function (response) {\n                console.log(response.status);\n                if (response.status !== 201) {\n                  throw new Error();\n                }\n                return response.json();\n              }).then(function (response) {\n                window.localStorage.setItem(\"loggedIn\", true);\n                window.localStorage.setItem(\"token\", response.token);\n                window.localStorage.setItem(\"username\", response.username);\n                setLoggedIn(true);\n                navigate(\"../\");\n              }).catch(function (e) {\n                register(values, form);\n              });\n            case 5:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n    return _login.apply(this, arguments);\n  }\n  function register(values, form) {\n    var myHeaders = new Headers();\n    myHeaders.append(\"Content-Type\", \"application/json\");\n    var raw = JSON.stringify({\n      email: values.email,\n      password: values.password,\n      username: values.username\n    });\n    var requestOptions = {\n      method: 'POST',\n      headers: myHeaders,\n      body: raw,\n      redirect: 'follow'\n    };\n    fetch(\"http://localhost:5001/auth/register/\", requestOptions).then(function (response) {\n      return response.json();\n    }).then(function (result) {\n      window.localStorage.setItem(\"loggedIn\", true);\n      window.localStorage.setItem(\"token\", result.token);\n      window.localStorage.setItem(\"username\", result.username);\n      setLoggedIn(true);\n      navigate(\"../\");\n    }).catch(function (error) {\n      form.setErrors({\n        email: true,\n        password: \"Invalid login/registration\"\n      });\n    });\n  }\n  function logout() {\n    // In Class TODO: Implement this function\n    window.localStorage.clear(\"loggedIn\");\n    setLoggedIn(false);\n    console.log(loggedIn);\n  }\n  return {\n    loggedIn: loggedIn,\n    login: login,\n    logout: logout\n  };\n}\n_s(useProvideAuth, \"/o0R229f834HPBnS8k6ksy8SO5Y=\", false, function () {\n  return [useNavigate];\n});","map":{"version":3,"names":["createContext","useState","useNavigate","AuthContext","useProvideAuth","navigate","window","localStorage","getItem","loggedIn","setLoggedIn","login","values","form","myHeaders","Headers","append","raw","JSON","stringify","email","password","requestOptions","method","headers","body","redirect","fetch","then","response","console","log","status","Error","json","setItem","token","username","catch","e","register","result","error","setErrors","logout","clear"],"sources":["/Users/justinsasek/Code/TPEO/full-stack-learning-repo-2022/Week_9/homework frontend/src/contexts/AuthContext.js"],"sourcesContent":["// based on the tutorial from https://usehooks.com/useAuth/\n\nimport { createContext, useState } from \"react\";\n// a bug with this hook prevented me from using it ðŸ˜¢\n// import { useLocalStorage } from \"@mantine/hooks\";\nimport { useNavigate } from \"react-router-dom\";\n\nlet AuthContext = createContext();\n\n// This is what we export from this file\nexport default AuthContext;\n\n// Provider hook that creates auth object and handles state\nexport function useProvideAuth() {\n  const navigate = useNavigate();\n  const [loggedIn, setLoggedIn] = useState(\n    window.localStorage.getItem(\"loggedIn\")\n  );\n\n\n  async function login(values, form) {\n    var myHeaders = new Headers();\n    myHeaders.append(\"Content-Type\", \"application/json\");\n\n    var raw = JSON.stringify({\n      email: values.email,\n      password: values.password\n    });\n\n    var requestOptions = {\n      method: 'POST',\n      headers: myHeaders,\n      body: raw,\n      redirect: 'follow'\n    };\n\n    fetch(\"http://localhost:5001/auth/login/\", requestOptions)\n      .then((response) => {\n        console.log(response.status);\n        if (response.status !== 201) {\n          throw new Error();\n        }\n        return response.json();\n      })\n      .then((response) => {\n        window.localStorage.setItem(\"loggedIn\", true);\n        window.localStorage.setItem(\"token\", response.token);\n        window.localStorage.setItem(\"username\", response.username);\n        setLoggedIn(true);\n        navigate(\"../\");\n      })\n      .catch((e) => {\n        register(values, form);\n      });\n  }\n\n  function register(values, form) {\n\n    var myHeaders = new Headers();\n    myHeaders.append(\"Content-Type\", \"application/json\");\n\n    var raw = JSON.stringify({\n      email: values.email,\n      password: values.password,\n      username: values.username\n    });\n\n    var requestOptions = {\n      method: 'POST',\n      headers: myHeaders,\n      body: raw,\n      redirect: 'follow'\n    };\n\n    fetch(\"http://localhost:5001/auth/register/\", requestOptions)\n      .then((response) => response.json())\n      .then((result) => {\n        window.localStorage.setItem(\"loggedIn\", true);\n        window.localStorage.setItem(\"token\", result.token);\n        window.localStorage.setItem(\"username\", result.username);\n        setLoggedIn(true);\n        navigate(\"../\");\n      })\n      .catch((error) => {\n        form.setErrors({ email: true, password: \"Invalid login/registration\" });\n      });\n  }\n\n  function logout() {\n    // In Class TODO: Implement this function\n    window.localStorage.clear(\"loggedIn\");\n    setLoggedIn(false);\n    console.log(loggedIn);\n  }\n\n  return {\n    loggedIn,\n    login,\n    logout\n  };\n}\n"],"mappings":";;;;AAAA;;AAEA,SAASA,aAAa,EAAEC,QAAQ,QAAQ,OAAO;AAC/C;AACA;AACA,SAASC,WAAW,QAAQ,kBAAkB;AAE9C,IAAIC,WAAW,gBAAGH,aAAa,EAAE;;AAEjC;AACA,eAAeG,WAAW;;AAE1B;AACA,OAAO,SAASC,cAAc,GAAG;EAAA;EAC/B,IAAMC,QAAQ,GAAGH,WAAW,EAAE;EAC9B,gBAAgCD,QAAQ,CACtCK,MAAM,CAACC,YAAY,CAACC,OAAO,CAAC,UAAU,CAAC,CACxC;IAAA;IAFMC,QAAQ;IAAEC,WAAW;EAE1B,SAGaC,KAAK;IAAA;EAAA;EAAA;IAAA,oEAApB,iBAAqBC,MAAM,EAAEC,IAAI;MAAA;MAAA;QAAA;UAAA;YAAA;cAC3BC,SAAS,GAAG,IAAIC,OAAO,EAAE;cAC7BD,SAAS,CAACE,MAAM,CAAC,cAAc,EAAE,kBAAkB,CAAC;cAEhDC,GAAG,GAAGC,IAAI,CAACC,SAAS,CAAC;gBACvBC,KAAK,EAAER,MAAM,CAACQ,KAAK;gBACnBC,QAAQ,EAAET,MAAM,CAACS;cACnB,CAAC,CAAC;cAEEC,cAAc,GAAG;gBACnBC,MAAM,EAAE,MAAM;gBACdC,OAAO,EAAEV,SAAS;gBAClBW,IAAI,EAAER,GAAG;gBACTS,QAAQ,EAAE;cACZ,CAAC;cAEDC,KAAK,CAAC,mCAAmC,EAAEL,cAAc,CAAC,CACvDM,IAAI,CAAC,UAACC,QAAQ,EAAK;gBAClBC,OAAO,CAACC,GAAG,CAACF,QAAQ,CAACG,MAAM,CAAC;gBAC5B,IAAIH,QAAQ,CAACG,MAAM,KAAK,GAAG,EAAE;kBAC3B,MAAM,IAAIC,KAAK,EAAE;gBACnB;gBACA,OAAOJ,QAAQ,CAACK,IAAI,EAAE;cACxB,CAAC,CAAC,CACDN,IAAI,CAAC,UAACC,QAAQ,EAAK;gBAClBvB,MAAM,CAACC,YAAY,CAAC4B,OAAO,CAAC,UAAU,EAAE,IAAI,CAAC;gBAC7C7B,MAAM,CAACC,YAAY,CAAC4B,OAAO,CAAC,OAAO,EAAEN,QAAQ,CAACO,KAAK,CAAC;gBACpD9B,MAAM,CAACC,YAAY,CAAC4B,OAAO,CAAC,UAAU,EAAEN,QAAQ,CAACQ,QAAQ,CAAC;gBAC1D3B,WAAW,CAAC,IAAI,CAAC;gBACjBL,QAAQ,CAAC,KAAK,CAAC;cACjB,CAAC,CAAC,CACDiC,KAAK,CAAC,UAACC,CAAC,EAAK;gBACZC,QAAQ,CAAC5B,MAAM,EAAEC,IAAI,CAAC;cACxB,CAAC,CAAC;YAAC;YAAA;cAAA;UAAA;QAAA;MAAA;IAAA,CACN;IAAA;EAAA;EAED,SAAS2B,QAAQ,CAAC5B,MAAM,EAAEC,IAAI,EAAE;IAE9B,IAAIC,SAAS,GAAG,IAAIC,OAAO,EAAE;IAC7BD,SAAS,CAACE,MAAM,CAAC,cAAc,EAAE,kBAAkB,CAAC;IAEpD,IAAIC,GAAG,GAAGC,IAAI,CAACC,SAAS,CAAC;MACvBC,KAAK,EAAER,MAAM,CAACQ,KAAK;MACnBC,QAAQ,EAAET,MAAM,CAACS,QAAQ;MACzBgB,QAAQ,EAAEzB,MAAM,CAACyB;IACnB,CAAC,CAAC;IAEF,IAAIf,cAAc,GAAG;MACnBC,MAAM,EAAE,MAAM;MACdC,OAAO,EAAEV,SAAS;MAClBW,IAAI,EAAER,GAAG;MACTS,QAAQ,EAAE;IACZ,CAAC;IAEDC,KAAK,CAAC,sCAAsC,EAAEL,cAAc,CAAC,CAC1DM,IAAI,CAAC,UAACC,QAAQ;MAAA,OAAKA,QAAQ,CAACK,IAAI,EAAE;IAAA,EAAC,CACnCN,IAAI,CAAC,UAACa,MAAM,EAAK;MAChBnC,MAAM,CAACC,YAAY,CAAC4B,OAAO,CAAC,UAAU,EAAE,IAAI,CAAC;MAC7C7B,MAAM,CAACC,YAAY,CAAC4B,OAAO,CAAC,OAAO,EAAEM,MAAM,CAACL,KAAK,CAAC;MAClD9B,MAAM,CAACC,YAAY,CAAC4B,OAAO,CAAC,UAAU,EAAEM,MAAM,CAACJ,QAAQ,CAAC;MACxD3B,WAAW,CAAC,IAAI,CAAC;MACjBL,QAAQ,CAAC,KAAK,CAAC;IACjB,CAAC,CAAC,CACDiC,KAAK,CAAC,UAACI,KAAK,EAAK;MAChB7B,IAAI,CAAC8B,SAAS,CAAC;QAAEvB,KAAK,EAAE,IAAI;QAAEC,QAAQ,EAAE;MAA6B,CAAC,CAAC;IACzE,CAAC,CAAC;EACN;EAEA,SAASuB,MAAM,GAAG;IAChB;IACAtC,MAAM,CAACC,YAAY,CAACsC,KAAK,CAAC,UAAU,CAAC;IACrCnC,WAAW,CAAC,KAAK,CAAC;IAClBoB,OAAO,CAACC,GAAG,CAACtB,QAAQ,CAAC;EACvB;EAEA,OAAO;IACLA,QAAQ,EAARA,QAAQ;IACRE,KAAK,EAALA,KAAK;IACLiC,MAAM,EAANA;EACF,CAAC;AACH;AAAC,GAvFexC,cAAc;EAAA,QACXF,WAAW;AAAA"},"metadata":{},"sourceType":"module"}